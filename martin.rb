#
# ATTENTION: This is an autogenerated file. See original at
#            https://github.com/maplibre/martin/blob/main/.github/files/homebrew.martin.rb.j2
#

class Martin < Formula
  current_version="1.2.0"

  desc "Blazing fast and lightweight tile server with PostGIS, MBTiles, and PMTiles support, plus an mbtiles tool"
  homepage "https://github.com/maplibre/martin"

  on_macos do
    on_arm do
      sha256 "beaae2a87c2c8481bf1f1324082e71d0e9d05100da75ac9cc451cb65601bab99"
      url "https://github.com/maplibre/martin/releases/download/martin-v#{current_version}/martin-aarch64-apple-darwin.tar.gz"
    end
    on_intel do
      sha256 "7cf0b7a14fc4d767bebd4e99d7a569ce8d0a4dcc485c5981736080196bb41148"
      url "https://github.com/maplibre/martin/releases/download/martin-v#{current_version}/martin-x86_64-apple-darwin.tar.gz"
    end
  end

  on_linux do
    on_arm do
      sha256 "d67e42fa2f4a61cca47e110768114d7ac28b874fb7f350645b598ff5382279f5"
      url "https://github.com/maplibre/martin/releases/download/martin-v#{current_version}/martin-aarch64-unknown-linux-musl.tar.gz"
    end
    on_intel do
      sha256 "0cddd16c5d7f04f0c83a4b1724f755239cbc0e21c2de307c75291356dbc3bbf6"
      url "https://github.com/maplibre/martin/releases/download/martin-v#{current_version}/martin-x86_64-unknown-linux-musl.tar.gz"
    end
  end

  version "#{current_version}"

  def install
    bin.install "martin"
    bin.install "martin-cp"
    bin.install "mbtiles"
  end

  def caveats; <<~EOS
    Martin requires a database connection string.
    It can be passed as a command-line argument or as a DATABASE_URL environment variable.
      martin postgres://postgres@localhost/db
  EOS
  end

  test do
    `#{bin}/martin --version`
    `#{bin}/martin-cp --version`
    `#{bin}/mbtiles --version`
  end
end
